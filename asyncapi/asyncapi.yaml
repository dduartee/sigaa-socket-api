asyncapi: 3.0.0
info:
  title: SIGAA Socket API
  version: 1.0.20
  description: |
    API WebSocket para integração com o sistema SIGAA (Sistema Integrado de Gestão de Atividades Acadêmicas).
    Documentação modularizada usando $ref para facilitar manutenção.
  contact:
    name: Gabriel Kleemann Duarte
    url: https://github.com/dduartee/sigaa-socket-api
  license:
    name: MIT
    url: https://github.com/dduartee/sigaa-socket-api/blob/main/LICENSE

defaultContentType: application/json

servers:
  production:
    host: '{host}:{port}'
    protocol: ws
    description: Servidor WebSocket de produção
    variables:
      host:
        default: localhost
      port:
        default: '5000'
    tags:
      - name: production
  development:
    host: '{host}:{port}'
    protocol: ws
    description: Servidor WebSocket de desenvolvimento
    variables:
      host:
        default: localhost
      port:
        default: '5000'
    tags:
      - name: development

channels:
  userLogin:
    $ref: './channels/userLogin.yaml'
  userLogoff:
    $ref: './channels/userLogoff.yaml'
  userStatus:
    $ref: './channels/userStatus.yaml'
  authValid:
    $ref: './channels/authValid.yaml'
  userInfo:
    $ref: './channels/userInfo.yaml'
  institutionsList:
    $ref: './channels/institutionsList.yaml'
  bondsList:
    $ref: './channels/bondsList.yaml'
  coursesList:
    $ref: './channels/coursesList.yaml'
  lessonsList:
    $ref: './channels/lessonsList.yaml'
  syllabusContent:
    $ref: './channels/syllabusContent.yaml'
  gradesList:
    $ref: './channels/gradesList.yaml'
  activitiesList:
    $ref: './channels/activitiesList.yaml'
  homeworkContent:
    $ref: './channels/homeworkContent.yaml'
  absencesList:
    $ref: './channels/absencesList.yaml'
  newsList:
    $ref: './channels/newsList.yaml'
  apiError:
    $ref: './channels/apiError.yaml'

operations:
  validateAuth:
    action: receive
    channel:
      $ref: '#/channels/authValid'
    summary: Valida token JWT
    description: Recebe requisição para validar token de autenticação JWT
    messages:
      - $ref: '#/channels/authValid/messages/AuthValidRequest'
    reply:
      channel:
        $ref: '#/channels/authValid'
      messages:
        - $ref: '#/channels/authValid/messages/AuthValidResponse'

  loginUser:
    action: receive
    channel:
      $ref: '#/channels/userLogin'
    summary: Autentica usuário
    description: Recebe credenciais e autentica usuário no SIGAA
    messages:
      - $ref: '#/channels/userLogin/messages/UserLoginRequest'
    reply:
      channel:
        $ref: '#/channels/userLogin'
      messages:
        - $ref: '#/channels/userLogin/messages/UserLoginResponse'

  getUserInfo:
    action: receive
    channel:
      $ref: '#/channels/userInfo'
    summary: Obtém informações do usuário
    description: Recebe requisição para obter dados do usuário autenticado
    messages:
      - $ref: '#/channels/userInfo/messages/EmptyRequest'
    reply:
      channel:
        $ref: '#/channels/userInfo'
      messages:
        - $ref: '#/channels/userInfo/messages/UserInfoResponse'

  logoffUser:
    action: receive
    channel:
      $ref: '#/channels/userLogoff'
    summary: Encerra sessão
    description: Encerra a sessão do usuário autenticado
    messages:
      - $ref: '#/channels/userLogoff/messages/EmptyRequest'

  sendUserStatus:
    action: send
    channel:
      $ref: '#/channels/userStatus'
    summary: Envia status do usuário
    description: Envia atualizações sobre o status de autenticação do usuário
    messages:
      - $ref: '#/channels/userStatus/messages/UserStatusUpdate'

  getBondsList:
    action: receive
    channel:
      $ref: '#/channels/bondsList'
    summary: Lista vínculos
    description: Recebe requisição para listar todos os vínculos acadêmicos do usuário
    messages:
      - $ref: '#/channels/bondsList/messages/BondsListRequest'
    reply:
      channel:
        $ref: '#/channels/bondsList'
      messages:
        - $ref: '#/channels/bondsList/messages/BondsListResponse'

  getCoursesList:
    action: receive
    channel:
      $ref: '#/channels/coursesList'
    summary: Lista disciplinas
    description: Recebe requisição para listar disciplinas de um vínculo específico
    messages:
      - $ref: '#/channels/coursesList/messages/CoursesListRequest'
    reply:
      channel:
        $ref: '#/channels/coursesList'
      messages:
        - $ref: '#/channels/coursesList/messages/CoursesListResponse'

  getGradesList:
    action: receive
    channel:
      $ref: '#/channels/gradesList'
    summary: Lista notas
    description: Recebe requisição para listar notas de todas as disciplinas de um vínculo
    messages:
      - $ref: '#/channels/gradesList/messages/GradesListRequest'
    reply:
      channel:
        $ref: '#/channels/gradesList'
      messages:
        - $ref: '#/channels/gradesList/messages/GradesListResponse'

  getActivitiesList:
    action: receive
    channel:
      $ref: '#/channels/activitiesList'
    summary: Lista atividades
    description: Recebe requisição para listar atividades pendentes de um vínculo
    messages:
      - $ref: '#/channels/activitiesList/messages/ActivitiesListRequest'
    reply:
      channel:
        $ref: '#/channels/activitiesList'
      messages:
        - $ref: '#/channels/activitiesList/messages/ActivitiesListResponse'

  getAbsencesList:
    action: receive
    channel:
      $ref: '#/channels/absencesList'
    summary: Lista faltas
    description: Recebe requisição para listar faltas de todas as disciplinas de um vínculo
    messages:
      - $ref: '#/channels/absencesList/messages/AbsencesListRequest'
    reply:
      channel:
        $ref: '#/channels/absencesList'
      messages:
        - $ref: '#/channels/absencesList/messages/AbsencesListResponse'

  getHomeworkContent:
    action: receive
    channel:
      $ref: '#/channels/homeworkContent'
    summary: Obtém conteúdo de tarefa
    description: Recebe requisição para obter detalhes completos de uma tarefa específica
    messages:
      - $ref: '#/channels/homeworkContent/messages/HomeworkContentRequest'
    reply:
      channel:
        $ref: '#/channels/homeworkContent'
      messages:
        - $ref: '#/channels/homeworkContent/messages/HomeworkContentResponse'

  getLessonsList:
    action: receive
    channel:
      $ref: '#/channels/lessonsList'
    summary: Lista aulas
    description: Recebe requisição para listar aulas de uma disciplina específica
    messages:
      - $ref: '#/channels/lessonsList/messages/LessonsListRequest'
    reply:
      channel:
        $ref: '#/channels/lessonsList'
      messages:
        - $ref: '#/channels/lessonsList/messages/LessonsListResponse'

  getNewsList:
    action: receive
    channel:
      $ref: '#/channels/newsList'
    summary: Lista notícias
    description: Recebe requisição para listar notícias de uma disciplina específica
    messages:
      - $ref: '#/channels/newsList/messages/NewsListRequest'
    reply:
      channel:
        $ref: '#/channels/newsList'
      messages:
        - $ref: '#/channels/newsList/messages/NewsListResponse'

  getSyllabusContent:
    action: receive
    channel:
      $ref: '#/channels/syllabusContent'
    summary: Obtém plano de ensino
    description: Recebe requisição para obter plano de ensino de uma disciplina específica
    messages:
      - $ref: '#/channels/syllabusContent/messages/SyllabusContentRequest'
    reply:
      channel:
        $ref: '#/channels/syllabusContent'
      messages:
        - $ref: '#/channels/syllabusContent/messages/SyllabusContentResponse'

  getInstitutionsList:
    action: receive
    channel:
      $ref: '#/channels/institutionsList'
    summary: Lista instituições
    description: Recebe requisição para listar todas as instituições de ensino compatíveis
    messages:
      - $ref: '#/channels/institutionsList/messages/InstitutionsListRequest'
    reply:
      channel:
        $ref: '#/channels/institutionsList'
      messages:
        - $ref: '#/channels/institutionsList/messages/InstitutionsListResponse'

  sendApiError:
    action: send
    channel:
      $ref: '#/channels/apiError'
    summary: Envia erro
    description: Envia mensagens de erro quando ocorrem problemas na API
    messages:
      - $ref: '#/channels/apiError/messages/ApiErrorMessage'

components:
  messages:
    $ref: './components/messages.yaml'
  schemas:
    $ref: './components/schemas.yaml'
  securitySchemes:
    $ref: './components/security.yaml'

